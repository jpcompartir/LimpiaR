<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="LimpiaR">
<title>LimpiaR - Parts of Speech Workflow • LimpiaR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="LimpiaR - Parts of Speech Workflow">
<meta property="og:description" content="LimpiaR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">LimpiaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/limpiar_intro.html">Introduction to LimpiaR</a>
    <a class="dropdown-item" href="../articles/parts_of_speech_workflow.html">LimpiaR - Parts of Speech Workflow</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jpcompartir/LimpiaR" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>LimpiaR - Parts of Speech Workflow</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jpcompartir/LimpiaR/tree/mainvignettes/parts_of_speech_workflow.Rmd" class="external-link"><code>vignettes/parts_of_speech_workflow.Rmd</code></a></small>
      <div class="d-none name"><code>parts_of_speech_workflow.Rmd</code></div>
    </div>

    
    
<style>
.callout, .callout-tip, .callout-warning {
  background-color: #f7f7f9;
  border-left: 5px solid #007bff;
  padding: 0.5rem;
  margin-top: 0.5rem;
  margin-bottom: 0.5rem;
}

.callout-warning {
  border-left: 5px solid #990000;
}

.callout-tip {
  border-left: 5px solid #66cdaa
}
</style>
<p>We want to take a document (or later a set of documents) like:</p>
<blockquote>
Who was the first person on the moon?
</blockquote>
<p>And extract for each token (where in this case token = word) in the
document its part of speech and its lemma. So that for each document we
have a table like:</p>
<table class="table">
<thead><tr class="header">
<th align="left">token</th>
<th align="left">lemma</th>
<th align="left">pos_tag</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Who</td>
<td align="left">who</td>
<td align="left">PRON</td>
</tr>
<tr class="even">
<td align="left">was</td>
<td align="left">be</td>
<td align="left">AUX</td>
</tr>
<tr class="odd">
<td align="left">the</td>
<td align="left">the</td>
<td align="left">DET</td>
</tr>
<tr class="even">
<td align="left">first</td>
<td align="left">first</td>
<td align="left">ADJ</td>
</tr>
<tr class="odd">
<td align="left">man</td>
<td align="left">man</td>
<td align="left">NOUN</td>
</tr>
<tr class="even">
<td align="left">on</td>
<td align="left">on</td>
<td align="left">ADP</td>
</tr>
<tr class="odd">
<td align="left">the</td>
<td align="left">the</td>
<td align="left">DET</td>
</tr>
<tr class="even">
<td align="left">moon</td>
<td align="left">moon</td>
<td align="left">NOUN</td>
</tr>
<tr class="odd">
<td align="left">?</td>
<td align="left">?</td>
<td align="left">PUNCT</td>
</tr>
</tbody>
</table>
<p>In this vignette we’ll be looking at how to use LimpiaR via {udpipe}
to achieve this. For a primer on parts of speech see <a href="https://en.wikipedia.org/wiki/Part_of_speech" class="external-link">Parts of Speech
Wikipedia</a>.</p>
<details><summary>
For all UPOS Tags use the following table as a reference:
</summary><table class="table">
<caption>Source: universaldependencies.org/u/pos</caption>
<colgroup>
<col width="11%">
<col width="3%">
<col width="85%">
</colgroup>
<thead><tr class="header">
<th align="left">Part of Speech</th>
<th align="left">UPOS Tag</th>
<th align="left">Definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Adjective</td>
<td align="left">ADJ</td>
<td align="left">Usually describes or modifies a noun. It provides
information about an object’s size, color, shape, etc. Example: “big”,
“blue”.</td>
</tr>
<tr class="even">
<td align="left">Adposition</td>
<td align="left">ADP</td>
<td align="left">Class of words that includes prepositions and
postpositions, used to express spatial or temporal relations or mark
various semantic roles. Example: “in”, “on”, “before”, “after”.</td>
</tr>
<tr class="odd">
<td align="left">Adverb</td>
<td align="left">ADV</td>
<td align="left">Modifies a verb, an adjective, another adverb, or even
an entire sentence. It provides information about manner, time, place,
frequency, degree, etc. Example: “quickly”, “very”.</td>
</tr>
<tr class="even">
<td align="left">Auxiliary</td>
<td align="left">AUX</td>
<td align="left">Special verb used to add functional or grammatical
meaning to the clause in which it appears. It accompanies the main verb
and forms different aspects, voices, or moods. Example: “is”, “have”,
“will”.</td>
</tr>
<tr class="odd">
<td align="left">Coordinating Conjunction</td>
<td align="left">CCONJ</td>
<td align="left">Joins words, phrases, or clauses of similar grammatical
status and syntactic importance. Example: “and”, “but”, “or”.</td>
</tr>
<tr class="even">
<td align="left">Determiner</td>
<td align="left">DET</td>
<td align="left">Introduces a noun and provides context in terms of
definiteness, where it belongs in a sequence, quantity, or ownership.
Example: “a”, “the”, “this”, “those”.</td>
</tr>
<tr class="odd">
<td align="left">Interjection</td>
<td align="left">INTJ</td>
<td align="left">An abrupt remark, made apart from the main sentence
structure, often used to express strong emotion or surprise. Example:
“Oh!”, “Wow!”, “Ugh!”.</td>
</tr>
<tr class="even">
<td align="left">Noun</td>
<td align="left">NOUN</td>
<td align="left">Represents a person, place, thing, or idea. Nouns can
be subjects, objects, or complement in a sentence. Example: “dog”,
“city”, “happiness”.</td>
</tr>
<tr class="odd">
<td align="left">Numeral</td>
<td align="left">NUM</td>
<td align="left">A word, symbol, or group of words representing a
number. Example: “one”, “first”, “100”.</td>
</tr>
<tr class="even">
<td align="left">Particle</td>
<td align="left">PART</td>
<td align="left">A function word that does not fit into the other
categories but is used to express grammatical relationships with other
words or to specify the attitude of the speaker. Example: “up” in “stand
up”.</td>
</tr>
<tr class="odd">
<td align="left">Pronoun</td>
<td align="left">PRON</td>
<td align="left">Replaces a noun, often used to avoid repetition.
Pronouns can do most things that nouns can do. Example: “he”, “they”,
“who”.</td>
</tr>
<tr class="even">
<td align="left">Proper Noun</td>
<td align="left">PROPN</td>
<td align="left">Names a specific person, place, thing, or idea and is
typically capitalized. Example: “Elizabeth”, “London”, “Microsoft”.</td>
</tr>
<tr class="odd">
<td align="left">Punctuation</td>
<td align="left">PUNCT</td>
<td align="left">Symbols that organize writing into clauses, phrases,
and sentences, clarify meaning, and indicate pauses. Example: “.”, “,”,
“!”.</td>
</tr>
<tr class="even">
<td align="left">Subordinating Conjunction</td>
<td align="left">SCONJ</td>
<td align="left">Introduces a subordinate clause and indicates the
relationship between the subordinate clause and the rest of the
sentence. Example: “because”, “although”, “when”.</td>
</tr>
<tr class="odd">
<td align="left">Symbol</td>
<td align="left">SYM</td>
<td align="left">A mark or character used as a conventional
representation of an object, function, or process. Example: “$”, “%”,
“&amp;”.</td>
</tr>
<tr class="even">
<td align="left">Verb</td>
<td align="left">VERB</td>
<td align="left">Expresses an action, occurrence, or state of being.
Verbs are central to a clause. Example: “run”, “be”, “have”.</td>
</tr>
<tr class="odd">
<td align="left">Other</td>
<td align="left">X</td>
<td align="left">A category used for words or tokens that do not fit
into the above categories. This is less common and often used in tagging
to mark anomalies or unclassifiable items.</td>
</tr>
</tbody>
</table></details><div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p>The main motivation for processing and extracting parts of speech is
to home in on the particular aspects of language which are most
informative for answering a given research question. For example, if you
want to know what people think about something, you might focus on
adjectives and nouns because adjectives describe things, and nouns are
things. If you want to know how people are using something, you might
focus more on verbs/phrasal verbs as they are ‘doing words’.</p>
<div class="section level3">
<h3 id="loading-packages">Loading packages<a class="anchor" aria-label="anchor" href="#loading-packages"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">LimpiaR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h3>
<p>LimpiaR’s PoS workflow leans on pre-existing functionality of the
{udpipe} package to allow users to import a pre-trained model for parts
of speech analysis whilst enabling advanced users to perform ‘dependency
parsing’.</p>
<details><summary>
What is dependency parsing?
</summary><p>“a technique which provides to each word in a sentence the link to
another word in the sentence, which is called its syntactical head. This
link between each 2 words furthermore has a certain type of relationship
giving you further details about it”</p>
<p>see <a href="https://www.r-bloggers.com/2019/07/dependency-parsing-with-udpipe/" class="external-link">here</a>
for more info.</p>
</details>
</div>
<div class="section level3">
<h3 id="importing-a-udpipe-model">Importing a udpipe model<a class="anchor" aria-label="anchor" href="#importing-a-udpipe-model"></a>
</h3>
<p>First, we import the model we want to use. UDPipe pre-trained models
are built upon Universal Dependencies treebanks and are made available
for more than 65 languages based on 101 treebanks. For demonstrative
purposes we’ll use <code>language = "english"</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/limpiar_pos_import_model.html">limpiar_pos_import_model</a></span><span class="op">(</span>language <span class="op">=</span> <span class="st">"english"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-data">Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>Now that we have our model imported into our session, let’s get some
data to tag, tokenise, lemmatise, and extract parts of speech. We need a
data frame with both a text variable and an ID column which uniquely
identifies each text.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="va"><a href="https://stringr.tidyverse.org/reference/stringr-data.html" class="external-link">sentences</a></span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                      universal_message_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"TWITTER"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 100 × 2</span></span></span>
<span><span class="co">##    text                                        universal_message_id</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> the birch canoe slid on the smooth planks.  TWITTER1            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> glue the sheet to the dark blue background. TWITTER2            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> it's easy to tell the depth of a well.      TWITTER3            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> these days a chicken leg is a rare dish.    TWITTER4            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> rice is often served in round bowls.        TWITTER5            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> the juice of lemons makes fine punch.       TWITTER6            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> the box was thrown beside the parked truck. TWITTER7            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> the hogs were fed chopped corn and garbage. TWITTER8            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> four hours of steady work faced us.         TWITTER9            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> a large size in stockings is hard to sell.  TWITTER10           </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 90 more rows</span></span></span></code></pre>
<p>So now we have some data and we also have our desired model loaded
into session, the function we need next is
<code><a href="../reference/limpiar_pos_annotate.html">limpiar_pos_annotate()</a></code>.</p>
<div class="callout">
<p>Before we begin, it’s important to note that our output will be
sensitive to cleaning steps. For example, it is possible that with the
removal of punctuation, PoS Tagging may under-perform. This could also
be said for the POS tagging process as nouns(NOUN) and
proper-nouns(PROPN) will be harder to differentiate if punctuation is
removed as well as all text being lowercase.</p>
<p>So be careful when pre-processing your text variable if you’re
intending to follow the PoS workflow.</p>
</div>
</div>
<div class="section level3">
<h3 id="extracting-parts-of-speech">Extracting parts of speech<a class="anchor" aria-label="anchor" href="#extracting-parts-of-speech"></a>
</h3>
<p>The<code>limpiar_pos_annotate</code> function converts the text of
each document into its tokens, lemmas, POS tags, and dependency
relationships*. The input data frame should have one document per row,
the return data frame will have one row per token. This means the return
data frame will have many more rows than the input data frame!</p>
<details><summary>
dependency_parse default value
</summary>
*the <code>dependency_parse</code> argument is set to <code>FALSE</code>
by default as this step can be costly in time and compute if performed
on large data sets. Most users will get by just fine without parsing
dependencies, but if you are sure you need them set this argument to
<code>TRUE</code>.
</details><p><code>limpiar_pos_annotate</code> can be sped up by using
<code>in_parallel = TRUE</code>, this argument makes the function
process multiple rows of the data frame in parallel.</p>
<div class="callout-warning">
<p>Running the function in parallel prevents the progress from being
updated.</p>
</div>
<p>By default the function will print its progress every 100 rows, this
way you know that it’s still working and roughly how long it should take
to finish running. If you don’t want the progress updates to print in
your console set <code>update_progress = 0</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># annotate texts and perform dependency parsing</span></span>
<span><span class="va">annotations</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/limpiar_pos_annotate.html">limpiar_pos_annotate</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, text_var <span class="op">=</span> <span class="va">text</span>, id_var <span class="op">=</span> <span class="va">universal_message_id</span>, pos_model <span class="op">=</span> <span class="va">model</span>, dependency_parse <span class="op">=</span> <span class="cn">TRUE</span>, in_parallel <span class="op">=</span> <span class="cn">FALSE</span>, update_progress <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2024-05-21 10:51:11.947981 Annotating text fragment 1/100</span></span>
<span><span class="co">## 2024-05-21 10:51:12.089532 Annotating text fragment 26/100</span></span>
<span><span class="co">## 2024-05-21 10:51:12.211263 Annotating text fragment 51/100</span></span>
<span><span class="co">## 2024-05-21 10:51:12.345818 Annotating text fragment 76/100</span></span></code></pre>
<p>Now that we have our texts tokenized, dependencies parsed, and POS
annotations are complete, let’s take a look at the output. After
annotating we have 882 rows, which is an 8.82x increase!</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annotations</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sentence</span>, <span class="va">feats</span>, <span class="va">xpos</span>, <span class="va">doc_id</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">universal_message_id</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 882 × 9</span></span></span>
<span><span class="co">##    universal_message_id paragraph_id sentence_id token_id token  lemma  pos_tag</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> TWITTER1                        1           1 1        the    the    DET    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> TWITTER1                        1           1 2        birch  birch  NOUN   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> TWITTER1                        1           1 3        canoe  canoe  NOUN   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> TWITTER1                        1           1 4        slid   slid   NOUN   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> TWITTER1                        1           1 5        on     on     ADP    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> TWITTER1                        1           1 6        the    the    DET    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> TWITTER1                        1           1 7        smooth smooth ADJ    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> TWITTER1                        1           1 8        planks plank  NOUN   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> TWITTER1                        1           1 9        .      .      PUNCT  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> TWITTER2                        1           1 1        glue   glue   VERB   </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 872 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 2 more variables: head_token_id &lt;chr&gt;, dependency_tag &lt;chr&gt;</span></span></span></code></pre>
<p>Output has some additional columns, we will pay closest attention to
paragraph_id, sentence_id, token, lemma, pos_tag, dependency_tag.</p>
<p>What are these new columns?</p>
<p><code>paragraph_id</code> and <code>sentence_id</code> tell us which
of the document’s paragraphs, and which sentence the token is in.
Because our data set contains only single sentences, all of these values
are 1.</p>
<p><code>token</code> is the word the rest of the columns refer to.</p>
<p><code>lemma</code> is the <a href="https://en.wikipedia.org/wiki/Lemmatization" class="external-link">lemmatised</a>
version of the token, an example of lemmatisation is ‘served’ being
converted to ‘serve’.</p>
<p><code>pos_tag</code> displays PoS labels such as; Noun(NOUN), Proper
Noun(PROPN), Pronoun(PRON), Verb(VERB), Adjective(ADJ) etc. For more on
the exact tags and what they mean see <a href="https://universaldependencies.org/u/pos/index.html" class="external-link">PoS Tags</a>
or the UPOS tags table at the top of this document.</p>
<p><code>dependency_tag</code> displays the dependency relation for each
token. Dependency relations are significantly more complicated than
parts of speech. see <a href="https://universaldependencies.org/u/dep/" class="external-link">Dependency Relations</a>
for more details.</p>
<p><code>head_token_id</code>, <code>dependency_tag</code> and
<code>feats</code> will only be present if we select
<code>dependency_parse = TRUE</code>, they tell us the id of the token
(inside the document, paragraph, sentence) which the token of that row
has the dependency relation to, the dependency relation and additional
features of the relationship</p>
<p>Finally, the column you inserted as <code>id_var =</code>. This
variable will help you to join the results back to your original data
frame.</p>
</div>
<div class="section level3">
<h3 id="manipulating-the-output">Manipulating the output<a class="anchor" aria-label="anchor" href="#manipulating-the-output"></a>
</h3>
<p>Now that we have adequate context, let’s look at what we can do with
our output.</p>
<p>We can combine commonly-used {dplyr} functions for data wrangling and
summarisation to filter for certain parts of speech and count their
occurrences.</p>
<p>Given the size of our data set there are limited inferences we can
make from the counts, but if we just want to know which adjectives are
seen most frequently:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Count adjectives</span></span>
<span><span class="va">annotations</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pos_tag</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ADJ"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">token</span>, <span class="va">pos_tag</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 65 × 3</span></span></span>
<span><span class="co">##    token pos_tag     n</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> blue  ADJ         3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> clear ADJ         3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> third ADJ         3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> large ADJ         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> more  ADJ         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> sharp ADJ         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> small ADJ         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> wide  ADJ         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> young ADJ         2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> bent  ADJ         1</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 55 more rows</span></span></span></code></pre>
<p>Alternatively we could do the same thing for nouns, but this time
count the lemma (in case of plurals).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Count the lemma of each noun</span></span>
<span><span class="va">annotations</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pos_tag</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NOUN"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># this time selecting nouns</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">lemma</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 214 × 2</span></span></span>
<span><span class="co">##    lemma     n</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> fence     3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> week      3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> air       2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> boy       2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> cat       2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> coat      2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> day       2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> fish      2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> girl      2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> grass     2</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 204 more rows</span></span></span></code></pre>
<div class="section level4">
<h4 id="adjective---noun-collocations">Adjective - Noun collocations<a class="anchor" aria-label="anchor" href="#adjective---noun-collocations"></a>
</h4>
<p>Are there any adjective -&gt; noun pairs seen more than once? This
task gets slightly more involved as we need to look at the value of each
token and the value in the next row, so first we need
<code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">dplyr::lag</a></code> +
<code><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">dplyr::lead</a></code>, and to group by the doc_id, paragraph_id and
sentence_id.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adj_to_noun</span> <span class="op">&lt;-</span> <span class="va">annotations</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">pos_tag</span> <span class="op">==</span> <span class="st">"ADJ"</span> <span class="op">&amp;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lead</a></span><span class="op">(</span><span class="va">pos_tag</span><span class="op">)</span> <span class="op">==</span> <span class="st">"NOUN"</span> <span class="op">|</span> <span class="va">pos_tag</span> <span class="op">==</span> <span class="st">"NOUN"</span> <span class="op">&amp;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">pos_tag</span><span class="op">)</span> <span class="op">==</span> <span class="st">"ADJ"</span>, .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">doc_id</span>, <span class="va">paragraph_id</span>, <span class="va">sentence_id</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then we’ll need to perform some more {dplyr} magic to count the
ADJ-NOUN collocations. The data is now set up so that row 1+2, 3+4, 4+5
and so on and so forth are ADJ-NOUN collocations, we can use this
information to extract the pairs with a combination of floor division,
exploiting how cumsum meshes with logicals in R, and a ‘grouped,
summarise paste with a flourish of collapse’ trick.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adj_to_noun</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>collocation_id <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">2</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>collocation_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">collocation_id</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>collocation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">token</span>, collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>, .by <span class="op">=</span> <span class="va">collocation_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">collocation</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 56 × 2</span></span></span>
<span><span class="co">##    collocation         n</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> third week          2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> bent hook           1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> big task            1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> blue air            1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> blue background     1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> blue fish           1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> clear response      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> clear spring        1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> clear water         1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> cloud hung          1</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 46 more rows</span></span></span></code></pre>
<p>The only ADJ-NOUN collocation seen more than once was ‘third week’.
In a larger data set we would expect to find more and higher-frequency
ADJ-NOUN collocations.</p>
<p>However, when manipulating the data this way, the onus is on the user
to know and understand what transformations should be created.</p>
</div>
<div class="section level4">
<h4 id="repairing-the-sentence">Repairing the sentence<a class="anchor" aria-label="anchor" href="#repairing-the-sentence"></a>
</h4>
<p>For this next example we’re going to convert all pos_tag == ADJ and
pos_tag == “NOUN” to their lemma, and stitch the sentences back together
so that they’re ready for visualisations. We’ll make use of case_when
and the now-familiar grouped summarise paste trick. If we group by
universal_message_id we’ll get back a 100 row data frame which we can
join back to our original data frame.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annotations</span> <span class="op">&lt;-</span> <span class="va">annotations</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>token <span class="op">=</span></span>
<span>           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">pos_tag</span> <span class="op">==</span> <span class="st">"ADJ"</span> <span class="op">~</span> <span class="va">lemma</span>,</span>
<span>                     <span class="va">pos_tag</span> <span class="op">==</span> <span class="st">"NOUN"</span> <span class="op">~</span> <span class="va">lemma</span>,</span>
<span>                     <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">lemma</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">token</span>, <span class="va">universal_message_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>sentence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">token</span>, collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>, </span>
<span>            .by <span class="op">=</span> <span class="va">universal_message_id</span><span class="op">)</span></span></code></pre></div>
<p>Once we have the information regarding the co-occurrences of nouns
and adjectives within our documents, we are able to evidence what
entities appear throughout our data, as well as the type of language
used in conjunction with and toward them. We can later add to this, by
visualizing the frequency of terms appearing within the same document as
well as those that are explicitly used one after another, just like the
example above, where we see ‘hot sun’ appear as most frequent.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="other-languages---spanish">Other languages - Spanish<a class="anchor" aria-label="anchor" href="#other-languages---spanish"></a>
</h2>
<p>The workflow for Spanish is very similar to English. We’ll select
language = “spanish” and then we’ll take a look at the output for a
Spanish document. We’ll take a paragraph from El Pais and store it in a
data frame named ‘spanish’</p>
<blockquote>
“Hace muchos años, cuando llegó a La Habana, encontró el mejor acto de
amor —el estudio de la escritura, que es aún mejor que el estudio de la
vida— por parte de la joven Yalenis Velazco, quien dedicó un intenso
ensayo a su obra.”
</blockquote>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spanish_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/limpiar_pos_import_model.html">limpiar_pos_import_model</a></span><span class="op">(</span><span class="st">"spanish"</span><span class="op">)</span> <span class="co"># Load the model </span></span>
<span></span>
<span><span class="va">spanish</span> <span class="op">&lt;-</span> <span class="va">spanish</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/limpiar_pos_annotate.html">limpiar_pos_annotate</a></span><span class="op">(</span><span class="va">text</span>, <span class="va">id</span>, <span class="va">spanish_model</span>, udpate_progress <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># Extract Pos Tags  </span></span></code></pre></div>
<pre><code><span><span class="co">## 2024-05-21 10:51:15.826813 Annotating text fragment 1/1</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spanish</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">token</span>, <span class="va">lemma</span>, <span class="va">pos_tag</span><span class="op">)</span> <span class="co"># Select relevant columns</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 49 × 3</span></span></span>
<span><span class="co">##    token  lemma  pos_tag</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Hace   hacer  VERB   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> muchos mucho  DET    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> años   año    NOUN   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> ,      ,      PUNCT  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> cuando cuando SCONJ  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> llegó  llegar VERB   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> a      a      ADP    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> La     el     DET    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Habana habana PROPN  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> ,      ,      PUNCT  </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 39 more rows</span></span></span></code></pre>
<p>We see immediately that ‘hace’ a conjugation of the verb ‘hacer’ is
converted to hacer, muchos -&gt; mucho, años -&gt; año. These changes
would generally be agreeable, they’ll help us to reduce the overall
number of words in our data set, and our text-based visualisations
should be cleaner. However, it is <em>always</em> a good idea to
carefully consider the effects of any transformation you perform on
data, rather than doing it blindly.</p>
<p>We can convert all verbs to lemma and stitch the document back
together using the same tricks as we did for English:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spanish</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    token <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pos_tag</span> <span class="op">==</span> <span class="st">"VERB"</span>, <span class="va">lemma</span>, <span class="va">token</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>.by <span class="op">=</span> <span class="va">id</span>,</span>
<span>            text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">token</span>, collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 2</span></span></span>
<span><span class="co">##      id text                                                                    </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                                   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1 hacer muchos años , cuando llegar a La Habana , encontrar el mejor acto…</span></span></code></pre>
<p>Clearly the sentence is now ungrammatical, but for a topic modelling
workflow or some n-gram networks, the data will be cleaner and the
counts will better reflect the real frequencies for each verb.</p>
<div class="callout-warning">
<p>No models are 100% correct, so we expect to see the occasional false
output. This is particularly true when it comes to languages other than
English which tend to have less training data, and be more grammatically
complex.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jack Penzer, Tim Mooney.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
