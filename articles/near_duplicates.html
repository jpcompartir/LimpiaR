<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Near Duplicate Removal • LimpiaR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Near Duplicate Removal">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">LimpiaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/limpiar_intro.html">Introduction to LimpiaR</a></li>
    <li><a class="dropdown-item" href="../articles/near_duplicates.html">Near Duplicate Removal</a></li>
    <li><a class="dropdown-item" href="../articles/parts_of_speech_workflow.html">LimpiaR - Parts of Speech Workflow</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jpcompartir/LimpiaR" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Near Duplicate Removal</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jpcompartir/LimpiaR/tree/main/vignettes/near_duplicates.Rmd" class="external-link"><code>vignettes/near_duplicates.Rmd</code></a></small>
      <div class="d-none name"><code>near_duplicates.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jpcompartir.github.io/LimpiaR">LimpiaR</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="quick-start---code">Quick Start - Code<a class="anchor" aria-label="anchor" href="#quick-start---code"></a>
</h2>
<p>Quick example of how to run the code for the function - get a dataset
with a text variable and:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">limpiar_examples</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/limpiar_spam_grams.html">limpiar_spam_grams</a></span><span class="op">(</span><span class="va">mention_content</span>, n_gram <span class="op">=</span> <span class="fl">3</span>, min_freq <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; $spam_grams</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 13 × 2</span></span></span>
<span><span class="co">#&gt;    ngrams                    n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> amigo sancho es           2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> de vdd jajaja             2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> en una muy                2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> es un wn                  2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> han metido en             2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> metido en una             2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> mi amigo sancho           2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> muy dificil situación     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> nos han metido            2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> sancho es un              2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> un wn de                  2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> una muy dificil           2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> wn de vdd                 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;   doc_id author_name  mention_content mention_url platform_interactions document</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      3 edmond_dant… <span style="color: #949494;">"</span>@don_quijote … www.twitte… <span style="color: #BB0000;">NA</span>                           3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>      6 robert_jord… <span style="color: #949494;">"</span>   Lo q no te… www.youtub… <span style="color: #BB0000;">NA</span>                           6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>      7 anselmo      <span style="color: #949494;">"</span>a mi es muy g… www.twitte… <span style="color: #BB0000;">NA</span>                           7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>      8 maria        <span style="color: #949494;">"</span>ayyy nooo @ro… www.twitte… <span style="color: #BB0000;">NA</span>                           8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>      9 pablo        <span style="color: #949494;">"</span>todos se unen… www.instag… <span style="color: #BB0000;">NA</span>                           9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     10 pilar        <span style="color: #949494;">"</span>a mi me gusta… www.instag… <span style="color: #BB0000;">NA</span>                          10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $deleted</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 6</span></span></span>
<span><span class="co">#&gt;   doc_id author_name  mention_content mention_url platform_interactions document</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      1 don_quijote  mi amigo sanch… www.twitte… <span style="color: #BB0000;">NA</span>                           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>      2 sancho_panza RT mi amigo sa… www.twitte… <span style="color: #BB0000;">NA</span>                           2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>      4 el_sordo     nos han metido… www.fakebo… <span style="color: #BB0000;">NA</span>                           4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>      5 commander_m… nos han metido… www.fakebo… <span style="color: #BB0000;">NA</span>                           5</span></span></code></pre></div>
<p>Now read the docs!</p>
</div>
<div class="section level2">
<h2 id="the-problem">The Problem<a class="anchor" aria-label="anchor" href="#the-problem"></a>
</h2>
<p>Extracting useful information from large, unstructured internet
datasets is a difficult task even when the datasets are clean. It is an
<em>impossible</em> task with datasets riddled by bot network content,
spammers, duplicates, and near-duplicates.</p>
<p>Sadly our datasets do not come ready-cleaned, and we often have to
remove hundreds and thousands of almost identical documents. Without
automated, or semi-automated, assistance, this process is extremely time
consuming and quickly becomes intractable as the size of our dataset
grows.</p>
<p>To make a bad situation worse, there is no one-size fits all
definition of ‘near duplicate’. Let’s look at two pairs of
documents:</p>
<p><strong>Pair 1</strong></p>
<blockquote>
<ol style="list-style-type: lower-roman">
<li>Arsenal are my favourite team</li>
<li>Liverpool are my favourite team</li>
</ol>
</blockquote>
<p><strong>Pair 2</strong></p>
<blockquote>
<ol style="list-style-type: lower-roman">
<li>
<span class="citation">@jiryan_2</span> wants to make you rich!
Click here for amazing crypto opportunity
www.definitelynotascam.com/get_rich_quick</li>
<li>
<span class="citation">@jiryan_2</span> wants to make you wealthy!
Click here for amazing crypto opportunity
www.definitelynotascam.com/get_rich_quick</li>
</ol>
</blockquote>
<p>It should be quite clear that one of these pairs of documents is more
problematic than the other, and yet both documents only differ by a
single world. So even in principle, we wouldn’t want to write some code
to ‘check if there is another document which only differs by one word,
and remove both documents if there is’ - we need something a bit more
nuanced.</p>
</div>
<div class="section level2">
<h2 id="a-solution---limpiar_spam_grams">A Solution - <code>limpiar_spam_grams()</code><a class="anchor" aria-label="anchor" href="#a-solution---limpiar_spam_grams"></a>
</h2>
<p>We developed an in-house solution which looks at recurrent n-grams <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;elsewhere called shingles&lt;/p&gt;"><sup>1</sup></a> within a
dataset, where grams are words - n = 1, bigrams are n = 2, trigrams are
n = 3 and so on. The algorithm is not language specific, so it can be
applied across any language which has clear delimiters between
words.</p>
<p>The algorithm works as follows:</p>
<ol style="list-style-type: decimal">
<li>We count the occurrence of every n-gram across all documents in our
dataset. Where the value of n is set by the user in the
<code>n_gram</code> parameter.</li>
<li>We filter the n-grams for those that occur above a
<code>min_freq</code>.</li>
<li>We filter our documents that have any n-gram from this list, we
retain documents that do not have any n-gram.</li>
<li>We return a list of: the ‘spam_grams’ - the n-grams which occur
above the <code>min_freq</code>, the remaining data, and the deleted
data, for the user to inspect.</li>
</ol>
<div class="section level3">
<h3 id="why-does-it-work">Why does it work?<a class="anchor" aria-label="anchor" href="#why-does-it-work"></a>
</h3>
<p><code><a href="../reference/limpiar_spam_grams.html">limpiar_spam_grams()</a></code> is an heuristic approach to
cleaning, it is simple but effective. The key insight for understanding
why it works is to think about <a href="https://en.wikipedia.org/wiki/Perplexity" target="_blank" class="external-link">perplexity</a> in the Information Theory/language
modelling sense. Sequences of natural language are high in perplexity -
for most ideas that we want to communicate, there are many words we
could choose from to communicate the idea. This means that two people
describing the same idea are unlikely to use the same words. So when
ideas are communicated with the exact same words, it is likely that they
have come from the same source, i.e. the process that generated them was
not independent. This is how we can recognise unsophisticated spammers
and bot networks.</p>
<p><strong>Sentence 1:</strong> The unexpected shower forced all the
beachgoers to quickly gather their belongings and seek shelter in nearby
buildings.</p>
<p><strong>Sentence 2:</strong> The sudden downpour prompted the seaside
visitors to hastily collect their items and dash into adjacent
structures.</p>
<p>The idea communicated is the same, but the words are different.</p>
</div>
<div class="section level3">
<h3 id="example-code">Example code<a class="anchor" aria-label="anchor" href="#example-code"></a>
</h3>
<p>Let’s run through some code to see how the function is applied. We’ll
save the output of <code><a href="../reference/limpiar_spam_grams.html">limpiar_spam_grams()</a></code> to a variable -
this variable will contain our list of $spam_grams, $data, $deleted.
We’ll use the <code>limpiar_examples</code> dataset, which is a small,
toy dataset of only 10 rows (documents). We can read every document in
this dataset, and quickly verify the outputs; so it is handy for
learning, but in reality we will be working with much larger datasets so
verification will take up more of our time.</p>
<p>We run the code with low values for <code>n_gram</code> and
<code>min_freq</code> because our dataset is small, and it does not
contain many near duplicates. We ask the function to find any substring
within a document of 3 words that is seen in the entire dataset that is
seen in at least 2 documents.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spam_grams_output</span> <span class="op">&lt;-</span> <span class="va">limpiar_examples</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/limpiar_spam_grams.html">limpiar_spam_grams</a></span><span class="op">(</span><span class="va">mention_content</span>, n_gram <span class="op">=</span> <span class="fl">3</span>, min_freq <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>We can check what’s in the list simply with <code><a href="https://rdrr.io/r/base/names.html" class="external-link">names()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spam_grams_output</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "spam_grams" "data"       "deleted"</span></span></code></pre></div>
<p>We confirm that we have the three elements of the list that we
expect. Now we can take a look at <code>spam_grams</code> to see what
ngrams the function is suggesting we delete:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spam_grams_output</span><span class="op">$</span><span class="va">spam_grams</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 13 × 2</span></span></span>
<span><span class="co">#&gt;    ngrams                    n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> amigo sancho es           2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> de vdd jajaja             2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> en una muy                2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> es un wn                  2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> han metido en             2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> metido en una             2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> mi amigo sancho           2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> muy dificil situación     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> nos han metido            2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> sancho es un              2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> un wn de                  2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> una muy dificil           2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> wn de vdd                 2</span></span></code></pre></div>
<p>If we look at the <code>ngrams</code> that have been picked out to do
the filtering, it’s clear that they ar e not the most robust. We could
imagine many documents that we do not in fact want to remove from a
datset, containing at least one of these ngrams. It’s vital that the
user inspects these ngrams and considers whether documents containing
them are likely to be spam-like.</p>
<p>If we move to inspecting the actual documents that were deleted, we
see that the ngrams in $spam_grams were coming from two pairs of
documents - one is a tweet + a retweet - by authors Don Quijote &amp;
Sancho Panza. The way retweets are formulated, it makes sense for them
to be treated as near duplicates. We also have a pair of exact
duplicates by EL Sordo and Commander Miranda - we would expect
duplicates to be flagged as near duplicates. So <strong>in this
case</strong> the function is working as intended.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spam_grams_output</span><span class="op">$</span><span class="va">deleted</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 6</span></span></span>
<span><span class="co">#&gt;   doc_id author_name  mention_content mention_url platform_interactions document</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      1 don_quijote  mi amigo sanch… www.twitte… <span style="color: #BB0000;">NA</span>                           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>      2 sancho_panza RT mi amigo sa… www.twitte… <span style="color: #BB0000;">NA</span>                           2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>      4 el_sordo     nos han metido… www.fakebo… <span style="color: #BB0000;">NA</span>                           4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>      5 commander_m… nos han metido… www.fakebo… <span style="color: #BB0000;">NA</span>                           5</span></span></code></pre></div>
<p>However, given what we noticed in the $spam_grams output, we would
not want to use these exact parameters on a larger dataset, because we
have too many ngrams which could be used in non-spam-like documents.</p>
<p>This raises a question, what should we set as starting parameters for
working with <code><a href="../reference/limpiar_spam_grams.html">limpiar_spam_grams()</a></code> on larger datasets?</p>
</div>
<div class="section level3">
<h3 id="parameter-settings">Parameter Settings<a class="anchor" aria-label="anchor" href="#parameter-settings"></a>
</h3>
<p>From experience and early research, we suggest setting
<code>ngram = 7</code> as a starting point, and <code>min_freq</code>
should be scaled with the number of documents in the dataset. Good
starting points would be to take the log of the size of the dataset, or
the square root.</p>
<p>Why the log or the square root?</p>
<div class="float">
<img src="images%2Fsource_made_it_up.png" alt="I made it up"><div class="figcaption">I made it up</div>
</div>
<p>Ultimately this decision is empirical - and you should be generating
data as you use the function, i.e. if you set
<code>min_freq = 10</code>, you’ll need to grab the $deleted data tibble
from the function’s output, and sample documents, counting and recording
how many you think are truly spam-like and should be removed. Keep doing
this until you find the parameter for which ~90% of documents are
spam-like. Record the outputs of your experiments.</p>
<div class="section level4">
<h4 id="trade-off">Trade-off<a class="anchor" aria-label="anchor" href="#trade-off"></a>
</h4>
<p>Setting the parameters results in a trade-off between <a href="https://jamiehshare.github.io/ds_share_handbook/model_evaluation.html#precision" class="external-link">precision
&amp; recall</a> - if you set <code>ngram = 1</code>, and
<code>min_freq =1</code>, you will remove every single document in your
dataset that has 1 word in it. This will result in 100% recall of spam
documents - because you remove every document. However, precision would
be low.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">limpiar_examples</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/limpiar_spam_grams.html">limpiar_spam_grams</a></span><span class="op">(</span><span class="va">mention_content</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; $spam_grams</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 56 × 2</span></span></span>
<span><span class="co">#&gt;    ngrams      n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> es          6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> mi          4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> muy         4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> un          4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> a           3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> amigo       3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> sancho      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> de          2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> dificil     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> en          2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 46 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 0 × 6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 6 variables: doc_id &lt;int&gt;, author_name &lt;chr&gt;, mention_content &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   mention_url &lt;chr&gt;, platform_interactions &lt;lgl&gt;, document &lt;int&gt;</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $deleted</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 6</span></span></span>
<span><span class="co">#&gt;    doc_id author_name mention_content mention_url platform_interactions document</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      1 don_quijote <span style="color: #949494;">"</span>mi amigo sanc… www.twitte… <span style="color: #BB0000;">NA</span>                           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      2 sancho_pan… <span style="color: #949494;">"</span>RT mi amigo s… www.twitte… <span style="color: #BB0000;">NA</span>                           2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      3 edmond_dan… <span style="color: #949494;">"</span>@don_quijote … www.twitte… <span style="color: #BB0000;">NA</span>                           3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      4 el_sordo    <span style="color: #949494;">"</span>nos han metid… www.fakebo… <span style="color: #BB0000;">NA</span>                           4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      5 commander_… <span style="color: #949494;">"</span>nos han metid… www.fakebo… <span style="color: #BB0000;">NA</span>                           5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      6 robert_jor… <span style="color: #949494;">"</span>   Lo q no te… www.youtub… <span style="color: #BB0000;">NA</span>                           6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      7 anselmo     <span style="color: #949494;">"</span>a mi es muy g… www.twitte… <span style="color: #BB0000;">NA</span>                           7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      8 maria       <span style="color: #949494;">"</span>ayyy nooo @ro… www.twitte… <span style="color: #BB0000;">NA</span>                           8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      9 pablo       <span style="color: #949494;">"</span>todos se unen… www.instag… <span style="color: #BB0000;">NA</span>                           9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     10 pilar       <span style="color: #949494;">"</span>a mi me gusta… www.instag… <span style="color: #BB0000;">NA</span>                          10</span></span></code></pre></div>
<p>We have some results from early research which shows this precision /
recall trade-off <img src="images%2Fspam_grams_classification_metrics.png" width="800" height="400" alt="Fig.1 Classification Metrics"></p>
</div>
</div>
<div class="section level3">
<h3 id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h3>
<p>Sometimes long substrings do not in fact indicate documents that we
should want to remove, for example, some long substrings will naturally
occur in many documents - for example when researching web browsers “I
set Chrome to my default browser” is an <code>ngram =7</code> which may
occur many times without indicating spam-like documents.</p>
<p>Likewise with quotes, you have probably seen this quote before many
times:</p>
<blockquote>
<p>‘Life is like riding a bicycle. To keep your balance, you must keep
moving.’</p>
</blockquote>
<p>It’s often used in blogs, articles, explainers etc. as a hook or as
supporting evidence. It is much longer than we would usually set the
value of our <code>ngram =</code> parameter, meaning if it is seen
across our documents more than <code>min_freq</code> times, then all of
those documents would be deleted. Although in this case it’s actually
quite unlikely to be a problem, the general principle is a limitation of
the approach.</p>
<p>Another limitation is that the function scales somewhat poorly with
the size of documents - if we have many long documents in a large corpus
of text, we will need a lot of time and memory to use
<code>limpiar_spam_grams</code> as it currently works. As we often need
to iterate over the parameters, this can be a barrier to usage.</p>
</div>
</div>
<div class="section level2">
<h2 id="another-solution">Another Solution<a class="anchor" aria-label="anchor" href="#another-solution"></a>
</h2>
<p>Coming soon:</p>
<p>Approximate Nearest Neighbours, Locality Sensitive Hashing, and
Jaccard Similarity</p>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jack Penzer, Tim Mooney.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
